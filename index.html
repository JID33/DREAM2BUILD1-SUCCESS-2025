<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dream2Build1 | Plateforme solidaire & digitale</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #f4faff;
      color: #222;
    }
    header {
      background-color: #5ec6f2;
      color: white;
      padding: 40px 20px;
      text-align: center;
    }
    nav {
      display: flex;
      justify-content: center;
      background-color: #3daee3;
      padding: 10px;
      flex-wrap: wrap;
      gap: 15px;
    }
    nav a {
      color: white;
      text-decoration: none;
      font-weight: bold;
      padding: 8px 15px;
      border-radius: 5px;
      background-color: #35a1d4;
    }
    .section {
      padding: 40px 20px;
      text-align: center;
    }
    .section h2 {
      color: #2a7da5;
    }
    .cta-buttons {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 20px;
    }
    .cta-buttons a {
      padding: 12px 20px;
      background-color: #00a8e8;
      color: white;
      text-decoration: none;
      border-radius: 25px;
      font-weight: bold;
    }
    .formulaire, .login-form {
      max-width: 500px;
      margin: 30px auto;
      background-color: #ffffff;
      border: 1px solid #cceeff;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
      text-align: left;
    }
    .formulaire input, .formulaire button,
    .login-form input, .login-form button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      box-sizing: border-box;
      font-size: 1em;
    }
    .formulaire button, .login-form button {
      background-color: #00a8e8;
      color: white;
      font-weight: bold;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .formulaire button:hover, .login-form button:hover {
      background-color: #008fcc;
    }
    .recu {
      display: none;
      background: #ffffff;
      border: 1px solid #cceeff;
      margin: 30px auto;
      padding: 20px;
      border-radius: 10px;
      max-width: 500px;
      text-align: left;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      font-size: 1em;
    }
    .recu h3 {
      margin-top: 0;
      color: #2a7da5;
    }
    .print-button {
      display: block;
      margin: 10px auto 0 auto;
      background-color: #0090c5;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .print-button:hover {
      background-color: #0077a8;
    }
    footer {
      text-align: center;
      padding: 20px;
      background-color: #3daee3;
      color: white;
      margin-top: 40px;
    }
    @media screen and (max-width: 600px) {
      header h1 {
        font-size: 1.8em;
      }
      nav {
        flex-direction: column;
        align-items: center;
      }
      .section {
        padding: 20px 10px;
      }
      .formulaire, .recu, .login-form {
        width: 90%;
        padding: 20px;
      }
    }
  </style>
</head>
<body>

<header>
  <h1>Dream2Build1</h1>
  <p>Une boutique solidaire et plateforme digitale au service de votre avenir</p>
</header>

<nav>
  <a href="#produits">Produits</a>
  <a href="#formations">Formations</a>
  <a href="#communaute">Communaut√©</a>
  <a href="#inscription">Inscription</a>
  <a href="#connexion">Connexion Admin</a>
</nav>

<section class="section" id="produits">
  <h2>üõí Nos Produits Num√©riques</h2>
  <p>D√©couvrez nos packs internet, guides, outils et mod√®les t√©l√©chargeables pour vous simplifier la vie.</p>
  <div class="cta-buttons">
    <a href="#inscription">Commander maintenant</a>
  </div>
</section>

<section class="section" id="formations">
  <h2>üéì Formations Pratiques</h2>
  <p>Apprenez √† utiliser les outils num√©riques, √† lancer un micro-business, et bien plus encore !</p>
  <div class="cta-buttons">
    <a href="#inscription">D√©couvrir nos services</a>
  </div>
</section>

<section class="section" id="communaute">
  <h2>üåç Une Communaut√© Solidaire</h2>
  <p>Rejoignez un r√©seau d'entraide et de croissance digitale en Ha√Øti et ailleurs.</p>
  <div class="cta-buttons">
    <a href="#inscription">Rejoindre la communaut√©</a>
  </div>
</section>

<section class="section" id="inscription">
  <h2>üìù Formulaire d‚Äôinscription</h2>
  <form class="formulaire" id="d2b1Form">
    <input type="text" name="nom" placeholder="Nom" required />
    <input type="text" name="prenom" placeholder="Pr√©nom" required />
    <input type="text" name="cin" placeholder="CIN ou NIF" required />
    <input type="email" name="email" placeholder="Email" required />
    <input type="text" name="whatsapp" placeholder="Num√©ro WhatsApp" required />
    <button type="submit">Envoyer</button>
  </form>
</section>

<div class="recu" id="recu">
  <h3>üìÑ Re√ßu de soumission</h3>
  <p><strong>Num√©ro de re√ßu :</strong> <span id="r_id"></span></p>
  <p><strong>Nom :</strong> <span id="r_nom"></span></p>
  <p><strong>Pr√©nom :</strong> <span id="r_prenom"></span></p>
  <p><strong>CIN/NIF :</strong> <span id="r_cin"></span></p>
  <p><strong>Email :</strong> <span id="r_email"></span></p>
  <p><strong>WhatsApp :</strong> <span id="r_whatsapp"></span></p>
  <button class="print-button" onclick="window.print()">üñ®Ô∏è Imprimer le re√ßu</button>
</div>

<section class="section" id="connexion">
  <h2>üîê Connexion Admin</h2>
  <form class="login-form">
    <input type="email" name="email" placeholder="Email" required />
    <input type="password" name="password" placeholder="Mot de passe" required />
    <button type="submit">Se connecter</button>
  </form>
</section>

<footer>
  &copy; 2025 Dream2Build1 ‚Äì Tous droits r√©serv√©s.
</footer>

<script>
  // G√©n√®re un ID unique de re√ßu au format D2B1-YYYYMMDD-XXX
  function generateReceiptID() {
    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth() + 1).padStart(2, '0');
    const dd = String(today.getDate()).padStart(2, '0');
    const datePart = `${yyyy}${mm}${dd}`;

    const countKey = `receiptCount-${datePart}`;
    let count = localStorage.getItem(countKey);
    count = count ? parseInt(count) + 1 : 1;
    localStorage.setItem(countKey, count);

    const paddedCount = String(count).padStart(3, '0');
    return `D2B1-${datePart}-${paddedCount}`;
  }

  // Envoi du formulaire inscription vers Google Apps Script
  async function sendForm(event) {
    event.preventDefault();
    const form = event.target;
    const receiptID = generateReceiptID();
    const data = {
      id: receiptID,
      nom: form.nom.value,
      prenom: form.prenom.value,
      cin: form.cin.value,
      email: form.email.value,
      whatsapp: form.whatsapp.value
    };

    try {
      const response = await fetch("https://script.google.com/macros/s/AKfycbzygsYr12TA5y9V4wEfoh7HcTyUUnp8AX8cA5Xm00PVRXnGwF225mNIwHcS8n2c820r5A/exec", {
        method: "POST",
        body: JSON.stringify(data),
        headers: { "Content-Type": "application/json" }
      });

      if (response.ok) {
        alert("Inscription envoy√©e avec succ√®s !");
        form.reset();
        afficherRecu(data);
      } else {
        alert("Erreur lors de l'envoi. Veuillez r√©essayer.");
      }
    } catch (error) {
      console.error(error);
      alert("Erreur r√©seau. V√©rifiez votre connexion.");
    }
  }

  // Affiche le re√ßu sur la page
  function afficherRecu(data) {
    document.getElementById("r_id").innerText = data.id;
    document.getElementById("r_nom").innerText = data.nom;
    document.getElementById("r_prenom").innerText = data.prenom;
    document.getElementById("r_cin").innerText = data.cin;
    document.getElementById("r_email").innerText = data.email;
    document.getElementById("r_whatsapp").innerText = data.whatsapp;
    document.getElementById("recu").style.display = "block";
    window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
  }

  // Listener sur formulaire inscription
  document.getElementById('d2b1Form').addEventListener('submit', sendForm);

  // Gestion connexion admin via fetch
  document.querySelector('.login-form').addEventListener('submit', function(event) {
    event.preventDefault();
    const email = this.email.value;
    const password = this.password.value;

    fetch("https://script.google.com/macros/s/AKfycbzFHk8Ew8MrPtxHI0_RglEvBUDk24QPrCD2ZGwxJ7k592RnKQf_U9OsG_8rcWNT6j88/exec?sheet=Login", {
      method: "POST",
      body: new URLSearchParams({ email, password }),
    })
    .then(res => res.text())
    .then(result => {
      if (result === "SUCCESS") {
        alert("Connexion r√©ussie !");
        window.location.href = "admin.html"; // Modifier si besoin l‚ÄôURL apr√®s login
      } else {
        alert("Identifiants invalides");
      }
    })
    .catch(() => alert("Erreur r√©seau. V√©rifiez votre connexion."));
  });
</script>

</body>
</html>
